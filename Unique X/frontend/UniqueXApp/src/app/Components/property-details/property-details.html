@if (property(); as prop) {
<div class="container py-4">
  <!-- 1. معرض الصور (Carousel) -->
 <div id="propertyCarousel" class="carousel slide shadow rounded-4 overflow-hidden mb-4" 
     data-bs-ride="carousel" 
     data-bs-pause="hover" 
     data-bs-interval="2000">
    <div class="carousel-inner">
      @for (photo of prop.photos; track photo.url; let i = $index) {
        <div class="carousel-item" [class.active]="i === 0">
          <img [src]="photo.url" class="d-block w-100 object-fit-cover" style="height: 500px;" alt="Property Image">
        </div>
      }
    </div>
    <!-- زر السابق -->
    <button class="carousel-control-prev" type="button" data-bs-target="#propertyCarousel" data-bs-slide="prev">
      <span class="carousel-control-prev-icon" aria-hidden="true"></span>
      <span class="visually-hidden">Previous</span>
    </button>

    <!-- زر التالي -->
    <button class="carousel-control-next" type="button" data-bs-target="#propertyCarousel" data-bs-slide="next">
      <span class="carousel-control-next-icon" aria-hidden="true"></span>
      <span class="visually-hidden">Next</span>
    </button>
  </div>

  <div class="row g-4">
    <!-- العمود الأيسر: التفاصيل -->
    <div class="col-lg-8">
      <div class="bg-white p-4 rounded-4 shadow-sm mb-4">
        <span class="badge bg-danger rounded-pill mb-2 px-3">{{ prop.listingType }}</span>
        <h2 class="fw-bold mb-1">EGP {{ prop.price | number }}</h2>
        <h4 class="text-dark mb-3">{{ prop.title }}</h4>
        <p class="text-muted"><i class="bi bi-geo-alt-fill text-danger me-2"></i>{{ prop.address }}, {{ prop.region }}, {{ prop.city }}</p>
        
        <div class="d-flex gap-4 border-top border-bottom py-3 my-4 justify-content-around text-center">
          <div><i class="bi bi-door-open fs-4 d-block text-danger"></i> <span class="fw-bold">{{ prop.rooms }}</span> <small class="text-muted d-block">Beds</small></div>
          <div><i class="bi bi-droplet fs-4 d-block text-danger"></i> <span class="fw-bold">{{ prop.bathrooms }}</span> <small class="text-muted d-block">Baths</small></div>
          <div><i class="bi bi-aspect-ratio fs-4 d-block text-danger"></i> <span class="fw-bold">{{ prop.area }}</span> <small class="text-muted d-block">Sqft</small></div>
          <div><i class="bi bi-building fs-4 d-block text-danger"></i> <span class="fw-bold">{{ prop.propertyType }}</span> <small class="text-muted d-block">Type</small></div>
        </div>

        <h5 class="fw-bold mb-3">Description</h5>
        <p class="text-muted lh-lg">{{ prop.description }}</p>
      </div>
    </div>

    <!-- العمود الأيمن: أزرار التواصل (ثابتة Sidebar) -->
    <div class="col-lg-4">
      <div class="card border-0 shadow-sm p-4 sticky-top" style="top: 100px; z-index: 10;">
        <div class="text-center mb-4">
          <div class="bg-danger text-white rounded-circle d-inline-flex align-items-center justify-content-center mb-3" style="width: 60px; height: 60px;">
            <i class="bi bi-person fs-2"></i>
          </div>
          <h5 class="fw-bold mb-0">{{ prop.brokerName }}</h5>
          <small class="text-muted">Listed by Agent</small>
        </div>

        <!-- زرار الاتصال الهاتفي -->
        <a [href]="'tel:' + prop.brokerPhone" class="btn btn-outline-dark btn-lg w-100 rounded-pill mb-3 fw-bold">
          <i class="bi bi-telephone-fill me-2"></i> Call Now
        </a>

        <!-- زرار الواتساب (WhatsApp Integration) -->
        <a [href]="'https://wa.me/' + prop.brokerPhone" target="_blank" class="btn btn-success btn-lg w-100 rounded-pill fw-bold">
          <i class="bi bi-whatsapp me-2"></i> WhatsApp
        </a>
      </div>
    </div>
  </div>
</div>
} @else {
  <div class="text-center py-5">
    <div class="spinner-border text-danger" role="status"></div>
    <p class="mt-3">Loading details...</p>
  </div>
}